{% extends "base.html" %}
{% block content %}
<div class="chat-container">
    <h2>Чат с {{ receiver_name }}</h2>
    <div id="messages" class="messages">
        <!-- Сообщения появятся здесь -->
    </div>
    <form id="messageForm">
        <input type="text" id="messageInput" placeholder="Введите сообщение" autocomplete="off">
        <button type="submit">Отправить</button>
    </form>
</div>
<script>
    const socket = io.connect();
    const messagesDiv = document.getElementById('messages');
    const messageForm = document.getElementById('messageForm');
    const messageInput = document.getElementById('messageInput');

    // Присоединение к комнате
    socket.emit('join', {});

    // Отправка сообщения
    messageForm.addEventListener('submit', (e) => {
        e.preventDefault();
        const message = messageInput.value;
        if (message) {
            socket.emit('send_message', {
                receiver_id: {{ receiver_id }},
                message: message
            });
            messageInput.value = '';
        }
    });

    // Получение сообщения
    socket.on('receive_message', (data) => {
        const message = document.createElement('div');
        message.textContent = `${data.sender}: ${data.message}`;
        messagesDiv.appendChild(message);
    });
</script>
{% endblock %}
